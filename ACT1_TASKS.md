# 1막 (바 운영) — 플레이어블 빌드 태스크 리스트

이 문서의 태스크를 순서대로 진행한다.
각 태스크가 끝나면 게임을 실행해서 동작을 확인한다.
다음 태스크로 넘어가기 전에 현재 태스크가 정상 작동해야 한다.

---

## Sprint 1: 기반 시스템 (하루 사이클이 돌아가는 것)

이 스프린트가 끝나면: 하루가 흐르고, 시간대가 바뀌고, 돈이 표시된다.

### Task 1-1: GameManager 리팩터링
- GameManager에 act 변수 추가 (현재 act = 1)
- 하루 사이클: morning → afternoon → evening → night
- 각 시간대에 제한 시간 있음 (evening이 바 운영 시간)
- 시간대 전환 시 SignalBus.time_phase_changed 발동
- 밤(night)이 되면 자동으로 하루 정산 → 다음 날로 넘어감
- **확인**: 화면에 "Day 1 - 오전" 같은 텍스트가 표시되고 시간이 흐르는지

### Task 1-2: 경제 시스템 기초
- 초기 자금: 5,000,000원 (퇴직금)
- Economy 싱글톤에 money 변수
- 돈 증감 함수: earn(amount), spend(amount) → bool (잔액 부족 시 false)
- SignalBus.money_changed 연동
- **확인**: HUD에 현재 잔액이 표시되고, 테스트로 돈이 줄어드는지

### Task 1-3: HUD 기본
- 화면 상단에 항상 표시:
  - 현재 날짜 (Day 1, Day 2...)
  - 현재 시간대 아이콘/텍스트 (오전/오후/저녁/밤)
  - 현재 잔액 (₩5,000,000)
  - 평판 (★ 1.0 ~ 5.0)
- 시간대에 따라 화면 색조 변화 (오전: 밝음, 저녁: 따뜻한 조명, 밤: 어두움)
- **확인**: HUD가 게임 내내 보이고, 날짜/시간/돈이 실시간 업데이트되는지

---

## Sprint 2: 바 공간 & 이동 (바가 실제 공간처럼 느껴지는 것)

이 스프린트가 끝나면: 바 안에서 돌아다니고, 카운터/좌석/문이 보인다.

### Task 2-1: 바 타일맵 (Lv1 허름한 바)
- 16x16 타일로 바 내부 구성
- 필수 구역: 카운터(바텐더 위치), 좌석 4개, 입구 문, 창고(뒤쪽)
- 아직 에셋 없으면 색깔 타일로 구분 (카운터=갈색, 바닥=회색, 벽=진회색)
- 벽/가구에 충돌 설정
- **확인**: 바 안에서 캐릭터가 걸어다니고 벽에 막히는지

### Task 2-2: 인터랙션 시스템
- 오브젝트에 다가가면 인터랙션 가능 표시 (E키 아이콘 or 말풍선)
- E키로 인터랙션 실행
- 인터랙션 가능 오브젝트: 카운터, 좌석, 문, 창고
- Area2D 기반으로 감지
- **확인**: 카운터에 다가가면 "E" 표시 나오고, 누르면 반응하는지

### Task 2-3: 씬 전환 (바 ↔ 시장)
- 바 문에서 E키 → 시장(마을) 씬으로 전환
- 시장은 일단 간단한 맵 (도매상 NPC 1명 + 돌아가는 문)
- 전환 시 페이드 인/아웃 연출
- **확인**: 바에서 나가서 시장에 갔다가 다시 바로 돌아올 수 있는지

---

## Sprint 3: 위스키 사입 (도매상에서 위스키를 사는 것)

이 스프린트가 끝나면: 시장에서 위스키를 골라 사고, 바에 재고가 쌓인다.

### Task 3-1: 위스키 카탈로그 데이터
- whisky_catalog.json에 위스키 10종 정의:
```json
{
  "id": "glenfiddich_12",
  "name": "글렌피딕 12년",
  "origin": "스코틀랜드 스페이사이드",
  "age": 12,
  "flavor_profile": {"sweet": 60, "fruity": 70, "floral": 40, "smoky": 10},
  "wholesale_price": 45000,
  "sell_price": 12000,
  "description": "사과, 배 향. 부드럽고 달콤한 입문용 싱글몰트"
}
```
- 다양한 가격대/풍미 커버:
  - 입문용 3종 (3~5만원대)
  - 중급 4종 (5~10만원대)  
  - 고급 2종 (10~20만원대)
  - 프리미엄 1종 (30만원+ 초반에 못 삼)
- **확인**: 데이터가 로드되고, 코드에서 접근 가능한지

### Task 3-2: 도매상 UI
- 시장 NPC에게 말 걸면 상점 UI 오픈
- 위스키 목록 표시 (이름, 산지, 가격, 풍미 요약)
- 구매 버튼 → 돈 차감 → 인벤토리에 추가
- 재고 한정 (하루 지나면 일부 리필, 고급은 랜덤으로 없을 수도)
- 잔액 부족 시 구매 불가 표시
- **확인**: 위스키를 사면 돈이 줄고, 인벤토리에 들어가는지

### Task 3-3: 인벤토리 (바 재고)
- 현재 보유 위스키 목록 + 수량
- 탭키(or I키)로 인벤토리 UI 토글
- 위스키별: 이름, 남은 수량, 잔당 판매가
- **확인**: 산 위스키가 인벤토리에 보이고, 수량이 맞는지

---

## Sprint 4: 바 영업 (손님이 오고 서빙하는 것)

이 스프린트가 끝나면: 저녁에 손님이 오고, 위스키를 서빙하고, 돈을 번다.

### Task 4-1: 손님 NPC 기본
- 저녁(evening) 시간대에 손님이 문으로 들어옴
- 빈 좌석에 자동으로 앉음 (좌석 4개 = 최대 4명)
- 일정 시간 후 주문 (말풍선에 취향 힌트 표시)
- 취향 타입: "스모키한 거", "달달한 거", "과일향 나는 거", "아무거나" 등
- 손님 데이터: customers.json에 타입별 정의
- **확인**: 저녁이 되면 손님이 들어와서 좌석에 앉고 주문하는지

### Task 4-2: 서빙 시스템
- 주문한 손님에게 다가가서 E키 → 위스키 선택 UI
- 내 재고 중 위스키 목록 표시
- 위스키 선택 → 서빙 → 취향 매칭 판정
- 매칭 점수: 손님 취향 vs 위스키 풍미 프로필 비교
  - 높은 매칭 (80%+): 😄 "이거 딱 제 스타일이에요!" → 높은 팁
  - 보통 매칭 (50~80%): 🙂 "괜찮네요" → 기본 가격
  - 낮은 매칭 (50% 미만): 😐 "음... 이건 좀..." → 팁 없음, 평판↓
- 서빙 후 손님 퇴장 → 좌석 비움 → 다음 손님
- **확인**: 위스키를 선택해서 서빙하면 매칭에 따라 반응이 다른지

### Task 4-3: 매출 & 하루 정산
- 서빙할 때마다 판매금액 + 팁 발생
- 밤(night) 진입 시 정산 화면:
  - 오늘 손님 수
  - 총 매출
  - 서빙 성공률 (매칭 평균)
  - 오늘 수입 - 비용(아직은 없음) = 순이익
  - 현재 총 잔액
- "다음 날" 버튼 → Day +1, morning으로
- **확인**: 하루 영업 후 정산 화면이 뜨고, 돈이 맞는지

---

## Sprint 5: 성장 루프 (돈 벌어서 투자하는 것)

이 스프린트가 끝나면: 돈을 벌어서 장비를 사고, 새 메뉴가 해금되고, 매출이 오른다.

### Task 5-1: 업그레이드 시스템 기초
- UpgradeManager 싱글톤 (or Autoload)
- upgrades.json에 업그레이드 항목 정의:
```json
{
  "id": "glass_lv2",
  "name": "글렌캐런 글라스",
  "category": "equipment",
  "cost": 200000,
  "prerequisite": null,
  "effect": {"satisfaction_bonus": 0.1},
  "description": "전용 잔으로 서빙하면 손님 만족도 +10%"
}
```
- 카테고리: equipment(장비), space(공간), interior(인테리어)
- 선행 조건 체크 (Lv2는 Lv1 구매 후 가능)
- **확인**: 업그레이드 데이터가 로드되는지

### Task 5-2: 업그레이드 상점 UI
- 바 안 특정 위치(노트북? 계산대?)에서 E키 → 업그레이드 UI
- 카테고리별 탭 (장비 / 공간 / 인테리어)
- 각 항목: 이름, 가격, 효과 설명, 구매 가능 여부
- 구매 → 돈 차감 → 효과 즉시 적용
- 이미 구매한 항목은 "보유중" 표시
- **확인**: 업그레이드를 사면 돈이 줄고 효과가 적용되는지

### Task 5-3: 장비 → 메뉴 해금 연동
- 탄산수 제조기 구매 → 하이볼 메뉴 해금
- 칵테일 장비 구매 → 올드 패션드 해금
- 해금된 메뉴는 서빙 시 선택지에 추가
- 칵테일/하이볼은 위스키보다 마진이 높음 (성장 보상)
- **확인**: 장비 사기 전엔 하이볼이 안 보이고, 사면 보이는지

### Task 5-4: 바 공간 업그레이드 (시각적 변화)
- 좌석 확장 (4→8): 타일맵에 좌석 4개 추가, 수용 손님 증가
- 인테리어 Lv1: 벽 타일 변경 (허름→깔끔), 조명 오브젝트 추가
- 업그레이드 시 실제 바 씬이 변하는 걸 눈으로 확인 가능해야 함
- **확인**: 좌석 업그레이드 후 손님이 8명까지 오는지, 바가 달라 보이는지

---

## Sprint 6: 직원 시스템 (혼자 힘들어지는 시점)

이 스프린트가 끝나면: 직원을 고용해서 서빙을 도와주고, 급여를 관리한다.

### Task 6-1: 직원 데이터 & 고용
- employees.json에 직원 타입 정의:
```json
{
  "type": "part_timer",
  "name_pool": ["민수", "지현", "태호", "수빈"],
  "daily_wage": 50000,
  "serve_speed": 0.6,
  "serve_quality": 0.5,
  "can_recommend": false,
  "can_cocktail": false
}
```
- 직원 타입: 서빙 알바(싸고 느림), 바텐더(비싸고 칵테일 가능), 매니저(자동화)
- 고용은 시장 or 바 내 게시판에서
- 고용 시 매일 급여 자동 차감
- **확인**: 직원을 고용하면 매일 급여가 빠지는지

### Task 6-2: 직원 AI (자동 서빙)
- 고용된 직원은 바 영업 시간에 자동으로 서빙
- 직원 NPC가 바 안에서 돌아다니며 손님에게 감 (시각적!)
- 직원의 서빙 품질은 플레이어보다 낮음 (추천 불가, 매칭 낮음)
- 플레이어가 직접 서빙하면 품질↑, 직원에게 맡기면 편하지만 품질↓
- 트레이드오프: 직접 하면 잘하지만 4명 한계 / 직원 쓰면 8명 가능하지만 팁↓
- **확인**: 직원이 자동으로 손님에게 가서 서빙하는 모습이 보이는지

### Task 6-3: 직원 성장
- 직원도 매일 경험치 획득 → 레벨업
- 레벨업 시 서빙 속도, 품질 소폭 상승
- 직원 관리 UI: 현재 직원 목록, 레벨, 급여, 해고 버튼
- **확인**: 며칠 지나면 직원 레벨이 오르고 성능이 좋아지는지

---

## Sprint 7: 평판 & 단골 (장기 동기 부여)

이 스프린트가 끝나면: 평판이 오르면 더 좋은 손님이 오고, 단골이 안정 수입을 준다.

### Task 7-1: 평판 시스템
- 평판 ★ 1.0 ~ 5.0 (초기 1.0)
- 매일 영업 결과에 따라 변동:
  - 매칭 좋으면 ↑, 나쁘면 ↓
  - 재고 떨어져서 못 팔면 ↓
  - 업그레이드 하면 소폭 ↑
- 평판에 따라:
  - ★1~2: 싼 위스키만 찾는 손님
  - ★2~3: 중급 위스키 원하는 손님 등장
  - ★3~4: 고급 위스키 원하는 손님 + 팁 많은 손님
  - ★4~5: VIP, 평론가, 외국인 관광객 등장
- **확인**: 잘 서빙하면 평판이 오르고, 오르면 새 타입 손님이 오는지

### Task 7-2: 단골 시스템
- 같은 손님이 만족하면 재방문 확률 증가
- 3회 이상 방문 시 "단골" 태그 → 이름 표시
- 단골은:
  - 매일 높은 확률로 방문
  - 취향이 고정되어 서빙하기 쉬움
  - 팁을 더 줌
  - 가끔 선물/정보 줌 (스토리 연계)
- **확인**: 반복 서빙한 손님이 단골이 되고, 매일 오는지

---

## Sprint 8: 스토리 이벤트 (1막 흐름이 생기는 것)

이 스프린트가 끝나면: 1막 스토리가 자연스럽게 흘러가고, 2막 전환점에 도달한다.

### Task 8-1: 대화 시스템
- 화면 하단 대화창 (캐릭터 이름 + 대사)
- NPC 말 걸기 or 이벤트 트리거로 발동
- 선택지 (2~3개) 가능
- dialogues.json에 대화 데이터
- **확인**: NPC에게 말 걸면 대화창이 뜨고 선택지가 나오는지

### Task 8-2: StoryManager 이벤트 체인
- Day 1: 오프닝 (퇴직 후 바를 열게 된 독백/내레이션)
- Day 3~5: 첫 단골 이벤트 ("여기 새로 열었네요? 자주 올게요")
- Day 10~15: 손님이 특정 위스키 요청 → 도매상에 재고 없음
  - "혹시 XX 위스키 있어요?" → "죄송합니다, 현재 재고가..." 
  - 이 경험이 2~3회 반복 (frustration 누적)
- Day 20: 도매상과 대화 "고급 위스키는 물량이 정해져 있어서..."
- Day 25~30: 핵심 전환 이벤트
  - 단골 손님: "사장님이 직접 만들어보시는 건 어때요?"
  - 혹은: 폐업한 증류소 매물 소식을 듣게 됨
  - 선택지: "증류소를 시작한다" → 2막 전환
- **확인**: 날짜에 맞춰 이벤트가 발동하고, 선택지가 2막으로 이어지는지

### Task 8-3: 오프닝 시퀀스
- 게임 시작 시 간단한 프롤로그:
  - "AI가 내 자리를 대체했다."
  - "퇴직금 5백만원. 이걸로 뭘 할 수 있을까."
  - "...바를 열자."
- 텍스트 + 간단한 연출 (페이드, 타이핑 효과)
- 프롤로그 후 바 씬으로 전환 → Day 1 시작
- **확인**: 게임 시작하면 프롤로그가 나오고 바로 이어지는지

---

## Sprint 9: 밸런싱 & 폴리시 (게임처럼 느껴지게)

이 스프린트가 끝나면: 1막이 30일 정도 플레이할 수 있는 완성된 경험이 된다.

### Task 9-1: 경제 밸런싱
- Day 1~5: 적자 or 간신히 흑자 (긴장감)
- Day 5~10: 단골 생기면서 안정 수입
- Day 10~20: 업그레이드 하나씩 가능한 수준
- Day 20~30: 직원 고용 가능, 장비 2~3개 업그레이드 완료
- 테스트 플레이로 수치 조정 (위스키 사입가, 판매가, 손님 수, 팁)
- **확인**: 30일 플레이했을 때 자연스러운 난이도 곡선이 느껴지는지

### Task 9-2: 시각/청각 피드백 (Juice)
- 돈 벌 때: 동전 소리 + 숫자 팝업 (+12,000원)
- 손님 만족: 이모지 이펙트 (😄 파티클)
- 손님 불만: 흔들림 이펙트
- 업그레이드 시: 팡파르 소리 + 화면 플래시
- 하루 시작: 문 여는 소리
- BGM: 저녁 바 분위기 (재즈? 로파이?)
- **확인**: 서빙할 때 "기분 좋은 피드백"이 있는지

### Task 9-3: 튜토리얼 (자연스러운 유도)
- Day 1: "시장에 가서 위스키를 사입하세요" (화살표 가이드)
- 첫 서빙: "손님의 취향을 보고 맞는 위스키를 골라보세요"
- 첫 수입: "오늘 번 돈으로 장비를 업그레이드할 수 있습니다"
- 강제 튜토리얼 아니고, 대화/힌트 형태로 자연스럽게
- **확인**: 처음 플레이하는 사람이 뭘 해야 하는지 알 수 있는지

---

## 완료 기준 (1막 플레이어블)

아래가 전부 되면 1막 완성:
- [ ] 게임 시작 → 프롤로그 → 바 씬 진입
- [ ] 시장에서 위스키 사입 가능
- [ ] 저녁에 손님이 오고 서빙 가능
- [ ] 매칭에 따라 만족도/팁 차등
- [ ] 하루 정산 화면
- [ ] 돈으로 장비/공간 업그레이드 가능
- [ ] 업그레이드하면 메뉴 해금 (하이볼, 칵테일)
- [ ] 업그레이드하면 바가 시각적으로 변함
- [ ] 직원 고용/관리 가능
- [ ] 평판 시스템 작동 (잘하면 좋은 손님 옴)
- [ ] 단골 시스템 작동
- [ ] 스토리 이벤트가 날짜에 맞춰 발동
- [ ] Day 25~30에 2막 전환점 도달
- [ ] 30일 플레이가 재미있고 자연스러움
